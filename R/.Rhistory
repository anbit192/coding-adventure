knitr::opts_chunk$set(echo = TRUE)
library(ISLR)
library(caret)
library(ggplot2)
library(pROC)
train = (Smarket$Year < 2004)
test = Smarket[!train, ]
glmfit = glm(Direction ~ . - Year - Today, data = Smarket, family = binomial, subset = train)
glmfit
test$pred = predict(glmfit, test, type = "response")
test$Dir_pred = ifelse(test$pred > 0.53, "Up", "Down")
names(test)
head(test$pred)
head(test$Dir_pred)
# chuyển kiểu dữ liệu của dir_pred thành factor (Factors are the data objects
# which are used to categorize the data and store it as levels.)
test$Dir_pred = as.factor(test$Dir_pred)
head(test$Direction)
confusionMatrix(test$Dir_pred, test$Direction)
roc(test$Direction ~ test$pred, plot = TRUE, print.auc = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(pls)
set.seed (2)
pcr.fit=pcr(Salary~., data=Hitters ,scale=TRUE, validation ="CV")
